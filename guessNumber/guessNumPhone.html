<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess the Number</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #container {
            max-width: 600px;
            padding: 20px;
            background-color: white;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            text-align: left;
        }

        h1 {
            color: #333;
        }

        h2 {
            color: #555;
        }

        p {
            color: #777;
            line-height: 1.5;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>
    <div id="container">
        <h1>Guess the Number</h1>
        <h2>概要</h2>
        <p>Guess the Numberは、正の約数の情報を元に00~99までのランダムな数字を当てるゲームです。少ない時間で正解することが目標です。</p>
        <h2>使い方</h2>
        <p>スタートするには「ゲームスタート」ボタンを押してください。</p>
        <h2>ゲームの流れ</h2>
        <p>①約数を予想する</p>
        <p>②約数の正誤と今までの約数と回答の情報が表示される</p>
        <p>③正解を予想する。</p>
        <p>④約数の正誤と今までの約数と回答の情報が表示される</p>
        <p>①に戻る</p>
        <button onclick="main()">ゲームスタート</button> <!--関数mainを実行する-->
    </div>
    <script>
        function main() { //ゲーム本体を動かす関数
            // 0から99までのランダムな整数を生成
            let number = Math.floor(Math.random() * 100);

            // 変数numberの約数を変数numberDivisorに代入する
            let numberDivisor = findDivisor(number);

            // playerが予想した変数numberを代入する変数
            let playerNumber = null;

            // 変数playerNumberを代入する配列
            let historyPlayerNumber = [];

            // playerが予想した約数を代入する変数
            let playerDivisor;

            // 変数playerDivisorの内、変数numberDivisorに含まれる数を代入する配列
            let truePlayerDivisor = [];

            // 変数playerDivisorの内、変数numberDivisorに含まれない数を代入する配列
            let falsePlayerDivisor = [];

            // 開始時刻を記録
            const startTime = performance.now();

            //数字を予想する動作の繰り返し
            while (number != playerNumber) {
                playerDivisor = parseInt(window.prompt("①0~99で約数の予想を入力してください."), 10); // 数値に変換

                if (numberDivisor.includes(playerDivisor) == true) {
                    truePlayerDivisor.push(playerDivisor);
                    truePlayerDivisor = ascendingOrder(truePlayerDivisor);

                    window.alert("②" + playerDivisor + "は約数です。\n約数である:" + truePlayerDivisor + "\n約数ではない:" + falsePlayerDivisor + "\nこれまでの回答:" + historyPlayerNumber);

                } else if (numberDivisor.includes(playerDivisor) == false) {
                    falsePlayerDivisor.push(playerDivisor);
                    falsePlayerDivisor = ascendingOrder(falsePlayerDivisor);

                    window.alert("②" + playerDivisor + "は約数ではないです。\n約数である:" + truePlayerDivisor + "\n約数ではない:" + falsePlayerDivisor + "\nこれまでの回答:" + historyPlayerNumber);
                }

                playerNumber = parseInt(window.prompt("③0~99で数字の予想を入力してください."), 10); // 数値に変換
                historyPlayerNumber.push(playerNumber);
                historyPlayerNumber = ascendingOrder(historyPlayerNumber);

                if (number != playerNumber) {
                    window.alert("④" + playerDivisor + "は約数ではないです。\n約数である:" + truePlayerDivisor + "\n約数ではない:" + falsePlayerDivisor + "\nこれまでの回答:" + historyPlayerNumber);
                }
            }

            // 終了時刻を記録
            const endTime = performance.now();

            let time = endTime - startTime;
            time = convertMillisecondsToTime(time);

            window.alert("おめでとうございます！正解は" + number + "です。\n約数は" + numberDivisor + "です。\nクリア時間は" + time + "です。");
        }

        function findDivisor(number) { // 約数を求める関数
            let divisor = [];

            if (number <= 0) {
                return divisor; // 0以下の数には約数が存在しない
            }

            for (let i = 1; i <= number; i++) {
                if (number % i === 0) {
                    divisor.push(i); // 約数の場合、divisor配列に追加
                }
            }

            return divisor;
        }

        function ascendingOrder(arr) {
            return arr.sort(function (first, second) {
                if (first > second) {
                    return 1;
                } else if (first < second) {
                    return -1;
                } else {
                    return 0;
                }
            });
        }

        function convertMillisecondsToTime(milliseconds) {
            const totalSeconds = Math.floor(milliseconds / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;

            const formattedHours = String(hours).padStart(2, '0');
            const formattedMinutes = String(minutes).padStart(2, '0');
            const formattedSeconds = String(seconds).padStart(2, '0');

            return `${formattedHours}:${formattedMinutes}:${formattedSeconds}`;
        }
    </script>
</body>

</html>